# 新人エンジニアのためのJenkins入門ガイド

## 🎯 Jenkinsとは？

**Jenkins**は、CI/CD（継続的インテグレーション/継続的デリバリー）を実現するための**オープンソースの自動化サーバー**です。

簡単に言うと：
> 「コードをコミットしたら、自動でビルド・テスト・デプロイしてくれる便利な執事さん」

## 🤔 なぜJenkinsが必要なのか？

### Jenkinsがない場合（手動作業）

```
開発者: コードを書く
     ↓
開発者: 手動でビルドコマンド実行
     ↓
開発者: 手動でテスト実行
     ↓
開発者: 結果を確認
     ↓
開発者: 問題があれば修正して最初から...
     ↓
開発者: 手動でサーバーにデプロイ
```

**問題点:**
- ⏰ 時間がかかる
- 😰 人的ミスが発生しやすい
- 🔄 毎回同じ作業の繰り返し
- 😴 夜中のデプロイ作業...

### Jenkinsがある場合（自動化）

```
開発者: コードをコミット
     ↓
Jenkins: 自動検知！
     ↓
Jenkins: 自動ビルド
     ↓
Jenkins: 自動テスト実行
     ↓
Jenkins: 結果を通知（Slack、メールなど）
     ↓
Jenkins: 自動デプロイ（設定による）
```

**メリット:**
- ⚡ 高速・即座にフィードバック
- 🎯 正確・ミスがない
- 🔄 一貫性のある処理
- 😊 開発者は開発に集中できる

## 🏗️ Jenkinsの基本構成

```
┌─────────────────────────────────────────┐
│         Jenkins Server (Master)          │
│  ┌─────────────────────────────────┐   │
│  │    Jenkins Dashboard (Web UI)    │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │         Job/Pipeline            │   │
│  │  • ビルド設定                    │   │
│  │  • テスト設定                    │   │
│  │  • デプロイ設定                  │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
         │           │           │
         ▼           ▼           ▼
    ┌────────┐  ┌────────┐  ┌────────┐
    │ Agent  │  │ Agent  │  │ Agent  │
    │ Node 1 │  │ Node 2 │  │ Node 3 │
    └────────┘  └────────┘  └────────┘
    実際の作業を実行するマシン
```

### 主要コンポーネント

1. **Master（マスター）**
   - Jenkinsのメインサーバー
   - ジョブのスケジューリング
   - Web UIの提供

2. **Agent/Node（エージェント/ノード）**
   - 実際にビルドやテストを実行するマシン
   - 複数のAgentで並列処理可能

3. **Job/Pipeline（ジョブ/パイプライン）**
   - 実行する作業の設定
   - 「何を、どの順番で実行するか」を定義

## 📋 Jenkinsの典型的なワークフロー

```
┌──────────────┐
│   Git/GitHub  │  開発者がコードをプッシュ
└───────┬──────┘
        │
        │ ① Webhook通知
        ▼
┌─────────────────────────────────────┐
│         Jenkins Master               │
│  「新しいコミットを検知！」          │
└───────┬─────────────────────────────┘
        │
        │ ② ジョブをトリガー
        ▼
┌─────────────────────────────────────┐
│         Jenkins Agent                │
│                                      │
│  ③ ソースコードを取得                │
│     git clone/pull                   │
│         ↓                            │
│  ④ ビルド実行                        │
│     npm install / mvn build          │
│         ↓                            │
│  ⑤ テスト実行                        │
│     npm test / mvn test              │
│         ↓                            │
│  ⑥ 静的解析                          │
│     ESLint / SonarQube               │
│         ↓                            │
│  ⑦ Artifact作成                      │
│     Docker image / JAR / WAR         │
└───────┬─────────────────────────────┘
        │
        │ ⑧ テスト結果・ログを保存
        ▼
┌─────────────────────────────────────┐
│         結果の通知                   │
│  • メール                            │
│  • Slack                             │
│  • Dashboard更新                     │
└─────────────────────────────────────┘
        │
        │ ⑨ 成功した場合
        ▼
┌─────────────────────────────────────┐
│      デプロイ（オプション）          │
│  • Staging環境へデプロイ             │
│  • 本番環境へデプロイ（承認後）      │
└─────────────────────────────────────┘
```

## 🎨 Jenkins Pipeline（パイプライン）とは？

**Pipeline**は、CI/CDのプロセスをコードで定義したものです。

### Declarative Pipeline（宣言的パイプライン）の例

```groovy
pipeline {
    agent any  // どのAgentで実行するか
    
    stages {
        stage('チェックアウト') {
            steps {
                // Gitからコードを取得
                git 'https://github.com/yourname/yourproject.git'
            }
        }
        
        stage('ビルド') {
            steps {
                // ビルドコマンド実行
                sh 'npm install'
                sh 'npm run build'
            }
        }
        
        stage('テスト') {
            steps {
                // テスト実行
                sh 'npm test'
            }
        }
        
        stage('デプロイ') {
            steps {
                // デプロイ処理
                sh './deploy.sh'
            }
        }
    }
    
    post {
        success {
            // 成功時の処理
            echo '全ての処理が成功しました！'
        }
        failure {
            // 失敗時の処理
            echo 'エラーが発生しました'
        }
    }
}
```

### パイプラインの視覚化

```
┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐
│ チェック    │ → │   ビルド    │ → │   テスト    │ → │  デプロイ   │
│ アウト      │   │             │   │             │   │             │
└─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘
    ✓ 成功            ✓ 成功            ✓ 成功            ✓ 成功

各ステージが順番に実行され、1つでも失敗すると全体が失敗
```

## 🔧 Jenkinsのインストールと初期設定

### 1. インストール方法（例：Docker使用）

```bash
# JenkinsをDockerで起動
docker run -d \
  -p 8080:8080 \
  -v jenkins_home:/var/jenkins_home \
  --name jenkins \
  jenkins/jenkins:lts
```

### 2. 初回セットアップの流れ

```
┌─────────────────────────────────────┐
│  1. ブラウザでアクセス               │
│     http://localhost:8080            │
└───────────┬─────────────────────────┘
            │
            ▼
┌─────────────────────────────────────┐
│  2. 初期パスワード入力               │
│     (ログに表示される)               │
└───────────┬─────────────────────────┘
            │
            ▼
┌─────────────────────────────────────┐
│  3. プラグインのインストール         │
│     推奨プラグインを選択             │
└───────────┬─────────────────────────┘
            │
            ▼
┌─────────────────────────────────────┐
│  4. 管理者ユーザー作成               │
└───────────┬─────────────────────────┘
            │
            ▼
┌─────────────────────────────────────┐
│  5. Jenkins起動！                    │
└─────────────────────────────────────┘
```

## 🎯 よく使うJenkinsプラグイン

| プラグイン名 | 用途 |
|------------|------|
| **Git Plugin** | Gitリポジトリと連携 |
| **Pipeline Plugin** | パイプラインを使用可能にする |
| **Docker Plugin** | Dockerコンテナでビルド実行 |
| **Slack Notification** | Slackへ通知 |
| **Blue Ocean** | モダンなUI提供 |
| **SonarQube Scanner** | コード品質分析 |

## 📊 Jenkinsのダッシュボード

```
┌─────────────────────────────────────────────────────┐
│                Jenkins Dashboard                     │
├─────────────────────────────────────────────────────┤
│                                                      │
│  📋 ジョブ一覧                                       │
│  ┌─────────────────────────────────────────────┐  │
│  │ ■ my-app-build            ✓ 成功  #123      │  │
│  │ ■ my-app-test             ✓ 成功  #45       │  │
│  │ ■ my-app-deploy           ✗ 失敗  #12       │  │
│  └─────────────────────────────────────────────┘  │
│                                                      │
│  📈 ビルド履歴                                       │
│  ┌─────────────────────────────────────────────┐  │
│  │  ████████████████░░  成功率: 85%            │  │
│  │                                              │  │
│  │  最近のビルド:                               │  │
│  │  #123  ✓  5分前                             │  │
│  │  #122  ✓  1時間前                           │  │
│  │  #121  ✗  2時間前 ← クリックで詳細確認       │  │
│  └─────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────┘
```

## 🚀 実践例：簡単なNode.jsアプリのCI/CD

### Jenkinsfile

```groovy
pipeline {
    agent {
        docker {
            image 'node:18'
        }
    }
    
    stages {
        stage('準備') {
            steps {
                echo 'ソースコードをチェックアウト'
                checkout scm
            }
        }
        
        stage('依存関係インストール') {
            steps {
                echo '依存パッケージをインストール'
                sh 'npm install'
            }
        }
        
        stage('Lint') {
            steps {
                echo 'コードの静的解析'
                sh 'npm run lint'
            }
        }
        
        stage('テスト') {
            steps {
                echo 'ユニットテスト実行'
                sh 'npm test'
            }
        }
        
        stage('ビルド') {
            steps {
                echo 'プロダクションビルド'
                sh 'npm run build'
            }
        }
        
        stage('デプロイ') {
            when {
                branch 'main'  // mainブランチのみ
            }
            steps {
                echo 'ステージング環境へデプロイ'
                sh './deploy-staging.sh'
            }
        }
    }
    
    post {
        success {
            echo '🎉 ビルド成功！'
            // Slack通知など
        }
        failure {
            echo '❌ ビルド失敗...'
            // エラー通知
        }
        always {
            // テスト結果の保存
            junit '**/test-results/*.xml'
        }
    }
}
```

## 💡 新人エンジニアへのアドバイス

### ✅ やるべきこと

1. **小さく始める**
   - まずは簡単なビルド＆テストから
   - 徐々に複雑なパイプラインへ

2. **ログを読む習慣**
   - ビルドが失敗したら必ずログを確認
   - エラーメッセージから原因を特定

3. **パイプラインをコード管理**
   - Jenkinsfileをリポジトリに含める
   - バージョン管理で変更履歴を追跡

4. **テストを書く**
   - 自動テストなしのCI/CDは意味がない
   - テストカバレッジを意識

### ❌ 避けるべきこと

1. **GUIでの設定に依存しすぎない**
   - Pipeline as Code（コードでパイプライン管理）を推奨
   - GUIの設定は再現性が低い

2. **シークレット情報をコードに書かない**
   - パスワード、APIキーなど
   - Jenkinsの認証情報管理機能を使う

3. **エラーを放置しない**
   - 壊れたビルドはすぐに修正
   - "後で直す"はNG

## 🔗 関連用語

- **CI (Continuous Integration)**: 継続的インテグレーション
- **CD (Continuous Delivery)**: 継続的デリバリー
- **CD (Continuous Deployment)**: 継続的デプロイメント
- **Pipeline**: 一連の処理フロー
- **Stage**: パイプラインの各段階
- **Agent**: 実際に作業を実行するマシン
- **Webhook**: イベント通知の仕組み

## 📚 さらに学ぶために

1. **公式ドキュメント**: https://www.jenkins.io/doc/
2. **Jenkins Pipeline チュートリアル**
3. **Blue Ocean（モダンUI）**を試してみる
4. **実際にプロジェクトで使ってみる**

---

## まとめ

Jenkinsは：
- 🤖 **自動化の執事**：面倒な作業を自動化
- 🔄 **CI/CDの要**：開発サイクルを高速化
- 🛠️ **柔軟なツール**：様々なプロジェクトに対応

最初は難しく感じるかもしれませんが、使っていくうちに「なくてはならないツール」になるはずです！

頑張ってください！💪